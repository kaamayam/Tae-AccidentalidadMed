shiny::runApp()
runApp()
runApp()
faithful
library(ggplot2)
library(tidyverse)
library(lubridate)
library(bsts)
datos<- readRDS(file = "bases_datos/datos.rds")
holidays_fecha<-readRDS(file = "bases_datos/Holidays.rds") %>% data.frame()
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE)) %>%
count() %>% data.frame()
setwd("~/Downloads/Tae-AccidentalidadMed")
library(ggplot2)
library(tidyverse)
library(lubridate)
library(bsts)
datos<- readRDS(file = "bases_datos/datos.rds")
holidays_fecha<-readRDS(file = "bases_datos/Holidays.rds") %>% data.frame()
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE)) %>%
count() %>% data.frame()
datos
View(datos)
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE)) %>%
count() %>% data.frame()
View(conteos)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) %>% geom_point()
library(ggplot2)
library(tidyverse)
library(lubridate)
library(bsts)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) %>% geom_point()
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) + geom_point()
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) + geom_point() %>% facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) + geom_point() = facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) + geom_point() + facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =n)) + geom_point(mapping = aes(color=CLASE_ACCIDENTE)) +
facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n)) + geom_point(mapping = aes(color=CLASE_ACCIDENTE)) +
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) + geom_point(mapping = aes(color=CLASE_ACCIDENTE)) +
facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) + geom_point(mapping = aes(color=CLASE_ACCIDENTE)) +
facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) + geom_point(mapping = aes(color=CLASE_ACCIDENTE)) +
facet_grid(CLASE_ACCIDENTE~.)
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) + geom_point(mapping = aes(color=CLASE_ACCIDENTE=='atropello'))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) + geom_point(mapping = aes(color=CLASE_ACCIDENTE[CLASE_ACCIDENTE=='atropello']))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) +
geom_point(mapping = aes(color=CLASE_ACCIDENTE[CLASE_ACCIDENTE=='atropello']))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) +
geom_point(mapping = aes(color=conteos[CLASE_ACCIDENTE=='atropello']))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) +
geom_point(mapping = aes(color=conteos[CLASE_ACCIDENTE=='atropello']))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) +
geom_point(mapping = aes(color=conteos[CLASE_ACCIDENTE=='atropello',]))
ggplot(data = conteos, mapping = aes(x=FECHA_ACCIDENTE, y =log(n))) +
geom_point(mapping = aes(color=conteos[,CLASE_ACCIDENTE=='atropello']))
ggplot(data = auto, aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteo, aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteos, aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteos[,CLASE_ACCIDENTE=='otro'], aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteos[,conteos$CLASE_ACCIDENTE=='otro'], aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteos[,conteos$CLASE_ACCIDENTE=='atropello'], aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
ggplot(data = conteos[conteos$CLASE_ACCIDENTE=='atropello',], aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
setwd("~/Downloads/Tae-AccidentalidadMed/app prueba/Prueba")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
holidays_fecha<-readRDS(file = "../bases_datos/Holidays.rds") %>% data.frame()
setwd("~/Downloads/Tae-AccidentalidadMed/app prueba/Prueba")
runApp()
# bases de datos
datos<- readRDS(file = "../../bases_datos/datos.rds")
holidays_fecha<-readRDS(file = "../../bases_datos/Holidays.rds") %>% data.frame()
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE)) %>%
count() %>% data.frame()
levels(conteos$CLASE_ACCIDENTE)
runApp()
ggplot(data = conteos[conteos$CLASE_ACCIDENTE==output$selector,], aes(x = FECHA_ACCIDENTE, y =n)) + geom_point(alpha = 1/2) +
geom_smooth(method = lm, col="blue")
runApp()
runApp()
shiny::runApp()
runApp()
shiny::runApp()
install.packages('rsconnect')
install.packages("rsconnect")
library(rsconnect)
rsconnect::deployApp('path/to/your/app')
setwd("~/Downloads/Tae-AccidentalidadMed/app prueba/Prueba")
shiny::runApp()
library(rsconnect)
runApp()
runApp()
setwd("/Volumes/GoogleDrive/Shared drives/National university of Colombia/TAE/TAE_archivos/Tarea1_tae")
a<-readRDS(file = "conteos.rds")
datos<- readRDS(file = "bases_datos/datos.rds")
View(datos)
names(datos)
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE),BARRIO,as.factor(COMUNA)) %>%
count() %>% data.frame()
View(conteos)
conteos <- datos %>% group_by(FECHA_ACCIDENTE, CLASE_ACCIDENTE=as.factor(CLASE_ACCIDENTE),BARRIO,COMUNA=as.factor(COMUNA)) %>%
count() %>% data.frame()
barrios_med=readOGR("../Barrios de Medellín/Barrio_Vereda.shp",layer="Barrio_Vereda")
library(rgdal)
library(leaflet)
barrios_med=readOGR("../Barrios de Medellín/Barrio_Vereda.shp",layer="Barrio_Vereda")
View(barrios_med)
print(barrios_med@data$NOMBRE)
barrios_med<-stri_trans_general(barrios_med,"Latin-ASCII")
library(stringi) #QUITAR TILDES
library(stringi)
barrios_med<-stri_trans_general(barrios_med,"Latin-ASCII")
class(barrios_med)
m=leaflet(barrios_med)
m=addTiles(m)
m
barrios_med
barrios_med@data
barrios_med@data$NOMBRE
barrios_med@data$NOMBRE %>% mutate(NOMBRE = tolower(barrios_med@data$NOMBRE))
tolower(barrios_med@data$NOMBRE)
stri_trans_general(barrios_med@data$NOMBRE,"Latin-ASCII")
barrios_med@data$NOMBRE
barrios_med@data$NOMBRE<-tolower(barrios_med@data$NOMBRE)
barrios_med@data$NOMBRE<-stri_trans_general(barrios_med@data$NOMBRE,"Latin-ASCII")
barrios_med@data$NOMBRE<-gsub(x = barrios_med@data$NOMBRE,pattern = "ñ",replacement = "n")
barrios_med@data$NOMBRE
m=leaflet(barrios_med)
m=addPolygons(m,popup=nombres_barrios)
m=addTiles(m)
m
m=addPolygons(m,popup=nombres_barrios)
nombres_barrios<-barrios_med@data$NOMBRE
m=addPolygons(m,popup=barrios_med@data$NOMBRE)
m=addTiles(m)
m
m=addTiles(c(m,conteos$n))
m=addTiles(conteos$n)
conteos$n
barrios_med@data
mapview(barrios_med)
library(mapview)
install.packages("mapview")
library(mapview)
mapview(barrios_med)
View(conteos)
View(barrios_med)
View(datos)
barrios_med@data
full_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
M<-full_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
mapview(M)
barrios_med@data <- full_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
mapview(barrios_med)
barrios_med@data
mapview(barrios_med[FECHA_ACCIDENTE=='2014-07-06',])
barrios_med@data[FECHA_ACCIDENTE=='2014-07-06',]
names
names(barrios_med@data)
barrios_med@data[barrios_med@data$FECHA_ACCIDENTE=='2014-07-06',]
barrios_med@data <- left_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
left_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
library(mapview)
library(rgdal)
library(leaflet)
library(tidyverse)
left_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
View(barrios_med)
barrios_med@data
is.na(barrios_med@data)
sum(is.na(barrios_med@data))
left_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
full_join(barrios_med@data, conteos, by= c("NOMBRE" = "BARRIO"))
#datos<- read.csv("incidentes_viales.csv", sep = ";",quote = "")
datos<- readRDS(file = "bases_datos/df.rds")
#datos<- read.csv("bases_datos/incidentes_viales.csv", sep = ";",quote = "")
holidays_fecha <- readRDS("bases_datos/Holidays.rds")%>% as.data.frame()
# datos
library(tidyverse)
setwd("~/Downloads/Tae-AccidentalidadMed")
#datos<- read.csv("bases_datos/incidentes_viales.csv", sep = ";",quote = "")
holidays_fecha <- readRDS("bases_datos/Holidays.rds")%>% as.data.frame()
barrios_med=readRDS("bases_datos/barrios_Medellin.rds")
conteos<- readRDS("bases_datos/conteos_con.rds")
str(conteos)
conteos$BARRIO<-as.factor(conteos$BARRIO)
str(conteos)
# particion de la base de datos
train <- conteos %>% filter(ano <= 2017)
train[118950,]<-c("2014-07-04","otro", "boqueron",
"corregimiento de san cristobal", 0 ,4,"Fri","Jul",2014,0)
train[118951,]<-c("2014-07-04","otro", "san jose del manzanillo",
"corregimiento de altavista", 0 ,4,"Fri","Jul",2014,0)
train[118952,]<-c("2014-07-04","otro", "el plan",
"corregimiento de santa elena", 0 ,4,"Fri","Jul",2014,0)
train[118953,]<-c("2014-07-04","otro", "la cuchilla",
"corregimiento de san cristobal", 0 ,4,"Fri","Jul",2014,0)
train[118954,]<-c("2014-07-04","otro", "piedra gorda",
"corregimiento de santa elena", 0 ,4,"Fri","Jul",2014,0)
train[118955,]<-c("2014-07-04","otro", "palmitas sector central",
"corregimiento de san sebastian de palmitas", 0 ,4,"Fri","Jul",2014,0)
train[118956,]<-c("2014-07-04","otro", "el astillero",
"corregimiento de san antonio de prado", 0 ,4,"Fri","Jul",2014,0)
train[118957,]<-c("2014-07-04","otro", "santa elena sector central",
"corregimiento de santa elena", 0 ,4,"Fri","Jul",2014,0)
train[118958,]<-c("2014-07-04","otro", "aguas frias",
"corregimiento de altavista", 0 ,4,"Fri","Jul",2014,0)
train[118959,]<-c("2014-07-04","otro", "la palma",
"belen", 0 ,4,"Fri","Jul",2014,0)
train[118960,]<-c("2014-07-04","otro", "volcana guayabal",
"corregimiento de san sebastian de palmitas", 0 ,4,"Fri","Jul",2014,0)
train[118961,]<-c("2014-07-04","otro", "el llano se",
"corregimiento de santa elena", 0 ,4,"Fri","Jul",2014,0)
train[118962,]<-c("2014-07-04","otro", "el uvito",
"corregimiento de san cristobal", 0 ,4,"Fri","Jul",2014,0)
train[118963,]<-c("2014-07-04","otro", "antioquia",
"aranjuez", 0 ,4,"Fri","Jul",2014,0)
train[118964,]<-c("2014-07-04","otro", "yarumalito",
"corregimiento de san antonio de prado", 0 ,4,"Fri","Jul",2014,0)
train$FECHA_ACCIDENTE <- as.Date(train$FECHA_ACCIDENTE, format = "%d/%m/%Y" )
train$n<-as.factor(train$n)
train$ano<-as.numeric(train$ano)
train$holi_bin<-as.factor(train$holi_bin)
train$dia_n<- as.numeric(train$dia_n)
train$n<- as.numeric(train$n)
str(train)
fit.1 <- glm (n ~ ano + mes + dia_n + dia + holi_bin + CLASE_ACCIDENTE + BARRIO,
family=poisson(link = log),data = train)
y_est1<- predict.glm(object = fit.1, newdata = train[,-5], type = "response")
y_est2<-predict(object = fit.1, newdata=test[,-5])
test <- conteos  %>% filter(ano >= 2020)
y_est2<-predict(object = fit.1, newdata=test[,-5])
mean((train$n - y_est1)^2)
mean((test$n - y_est2)^2)
# particion de la base de datos
#train <- conteos %>% filter(ano <= 2017)
#train<- readRDS("bases_datos/train.rds")
saveRDS(train, "train.rds")
saveRDS(conteos, "conteos_con.rds")
conteos<- readRDS("bases_datos/conteos_con.rds")
str(conteos)
#summary(fit.1)
saveRDS(fit.1, "modelo_glm.rds")
mean((train$n - y_est1)^2)
mean((test$n - y_est2)^2)
(0.3691837-0.337826)/0.337826
View(holidays_fecha)
View(holidays_fecha)
